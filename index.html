<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="assets/css/bootstrap-reboot.css">
    <link rel="stylesheet" href="assets/css/bootstrap.css">
    <link rel="stylesheet" href="assets/css/bootstrap-grid.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/mainStyle.css">
    <title>DEI Transmittal System</title>
    <style>
/* .dropdown-toggle:hover > .dropdown-menu {
  display: block;
} */
    </style>
</head>
<body>

    <div class="container">
        <div id="mainBody">
            <h2 class="font-italic font-weight-bold text-center main-page">DEI Transmittal System</h2>
            <div class="row text-center">
                <div class="col-md-3">
                    <div class="btn-group">
                        <button type="button" class="btn btn-primary" onclick="location.href='./transmittal';">Transmittal</button>
                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="assets/php/mainSearch.php?type=1">Last</a>
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#trSearch">Search</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="btn-group">
                        <button type="button" class="btn btn-primary" onclick="location.href='./fax';">Fax Transmittal</button>
                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="assets/php/mainSearch.php?type=2">Last</a>
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#faxSearch">Search</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">

                    <div class="btn-group">
                        <button type="button" class="btn btn-primary" onclick="location.href='./billplot';">Bill Plots</button>
                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="assets/php/mainSearch.php?type=3">Last</a>
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#pbSearch">Search</a>
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#plotPrices">Plotting Prices</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <a class="btn btn-primary " href="#" data-toggle="modal" data-target="#labelModal">Envelope/Label</a>
                </div>
            </div>
            <div class="settings text-center">
                <a class="btn btn-primary" href="../intranet/jnsearch.html">Exit</a>
                <a class="btn btn-primary" href="#" data-toggle="modal" data-target="#settingsModal"><i class="fa fa-cog"></i></a>
            </div>
        </div>
    </div>

    <!-- Settings/Preferences Modal -->
    <div class="modal fade" id="settingsModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-wide" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Settings</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group row">
                            <label for="deiComp" class="col-sm-2">Co. Name</label>
                            <div class="col-sm-10">
                                <input type="text" id="deiComp" class="form-control form-control-sm" placeholder="DICKERSON ENGINEERING, INC." readonly>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="deiAddr1" class="col-sm-2">Address</label>
                            <div class="col-sm-10">
                                <input type="text" id="deiAddr1" class="form-control form-control-sm" placeholder="3343 N Ridge Ave" readonly>
                                <input type="text" id="deiAddr2" class="form-control form-control-sm" readonly>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="deiCity" class="col-sm-1">City</label>
                            <div class="col-sm-7">
                                <input type="text" id="deiCity" class="form-control form-control-sm" placeholder="Arlington Heights" readonly>
                            </div>
                            <label for="deiState" class="col-sm-1">State</label>
                            <div class="col-sm-3">
                                <input type="text" id="deiState" class="form-control form-control-sm" placeholder="IL" readonly>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="deiZip" class="col-sm-1">Zip</label>
                            <div class="col-sm-7">
                                <input type="text" id="deiZip" class="form-control form-control-sm" placeholder="60004" readonly>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="deiFax" class="col-sm-1">Fax</label>
                            <div class="col-sm-7">
                                <input type="text" id="deiFax" class="form-control form-control-sm" placeholder="(847) 966-0294" readonly>
                            </div>
                            <label for="deiCode" class="col-sm-1">Code</label>
                            <div class="col-sm-3">
                                <input type="text" id="deiCode" class="form-control form-control-sm" placeholder="DEI" readonly>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="trNo" class="col-sm-6">Transmittal SerialNo.</label>
                            <div class="col-sm-6">
                                <input type="text" id="trNo" class="form-control form-control-sm" readonly>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="faxNo" class="col-sm-6">Fax Transmittal SerialNo.</label>
                            <div class="col-sm-6">
                                <input type="text" id="faxNo" class="form-control form-control-sm" readonly>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="pbNo" class="col-sm-6">Plot bill InvoiceNo.</label>
                            <div class="col-sm-6">
                                <input type="text" id="pbNo" class="form-control form-control-sm" readonly>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Transmittal Search -->
    <div class="modal fade" id="trSearch" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Search Transmittal</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="assets/php/mainSearch.php" method="post">
                        <input type="hidden" name="type" value="1">
                        <div class="form-group row">
                            <label for="trStart" class="col-sm-3">Start Date:</label>
                            <div class="col-sm-9">
                                <input type="date" id="trStart" name="startDate" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="trEnd" class="col-sm-3">End Date:</label>
                            <div class="col-sm-9">
                                <input type="date" id="trEnd" name="endDate" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="trJn" class="col-sm-3">Job Number:</label>
                            <div class="col-sm-9">
                                <input type="text" id="trJn" name="jobNumber" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="trCode" class="col-sm-3">Client Code:</label>
                            <div class="col-sm-9">
                                <input type="text" id="trCode" name="clientCode" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="trSignature" class="col-sm-3">Signature:</label>
                            <div class="col-sm-9">
                                <input type="text" id="trSignature" name="signature" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <input type="submit" class="btn btn-primary" value="Search">
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Fax Transmittal Search-->
    <div class="modal fade" id="faxSearch" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Search Fax Transmittals</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="assets/php/mainSearch.php" method="post">
                        <input type="hidden" name="type" value="2">
                        <div class="form-group row">
                            <label for="faxStart" class="col-sm-3">Start Date:</label>
                            <div class="col-sm-9">
                                <input type="date" id="faxStart" name="startDate" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="faxEnd" class="col-sm-3">End Date:</label>
                            <div class="col-sm-9">
                                <input type="date" id="faxEnd" name="endDate" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="faxJn" class="col-sm-3">Job Number:</label>
                            <div class="col-sm-9">
                                <input type="text" id="faxJn" name="jobNumber" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="faxCode" class="col-sm-3">Client Code:</label>
                            <div class="col-sm-9">
                                <input type="text" id="faxCode" name="clientCode" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="faxSignature" class="col-sm-3">Signature:</label>
                            <div class="col-sm-9">
                                <input type="text" id="faxSignature" name="signature" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <input type="submit" class="btn btn-primary" value="Search">
                        </div>

                    </form>
                </div>

            </div>
        </div>
    </div>
    <!-- Bill Plot Search -->
    <div class="modal fade" id="pbSearch" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Search Bill Plots</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="assets/php/mainSearch.php" method="post">
                        <input type="hidden" name="type" value="3">
                        <div class="form-group row">
                            <label for="pbStart" class="col-sm-3">Start Date:</label>
                            <div class="col-sm-9">
                                <input type="date" id="pbStart" name="startDate" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="pbEnd" class="col-sm-3">End Date:</label>
                            <div class="col-sm-9">
                                <input type="date" id="pbEnd" name="endDate" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="pbJn" class="col-sm-3">Job Number:</label>
                            <div class="col-sm-9">
                                <input type="text" id="pbJn" name="jobNumber" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="pbCode" class="col-sm-3">Client Code:</label>
                            <div class="col-sm-9">
                                <input type="text" id="pbCode" name="clientCode" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="pbInvoice" class="col-sm-3">InvoiceNo:</label>
                            <div class="col-sm-9">
                                <input type="text" id="pbInvoice" name="invoiceNo" class="form-control form-control-sm">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <input type="submit" class="btn btn-primary" value="Search">
                        </div>

                    </form>
                </div>

            </div>
        </div>
    </div>

    <!-- Print Label/Envelope Modal -->
    <div class="modal fade" id="labelModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Print Label/Envelope</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="labelForm">
                        <div class="form-group row">
                            <div class="col-6"><input type="text" class="form-control form-control-sm" name="jobNumber" id="jobNumber" placeholder="Job Number"></div>
                            <div class="col-6"><input type="text" class="form-control form-control-sm" name="clientCode" id="clientCode" placeholder = "Client Code"></div>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control form-control-sm" name="company" id="company" placeholder="Company">
                            <input type="text" class="form-control form-control-sm" name="addr1" id="addr1" placeholder="Address Line 1">
                            <input type="text" class="form-control form-control-sm" name="addr2" id="addr2" placeholder="Address Line 2">
                            <input type="text" class="form-control form-control-sm" name="city" id="city" placeholder="City">
                            <div class="row">
                                <div class="col-6"><input type="text" class="form-control form-control-sm" name="state" id="state" placeholder="State"></div>
                                <div class="col-6"><input type="text" class="form-control form-control-sm" name="zip" id="zip" placeholder="Zip"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control form-control-sm" name="attention" id="attention" placeholder="Attention" list="clientNames">
                            <datalist id="clientNames"></datalist>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                            <input type="submit" class="btn btn-primary" name="submit" id="envelopeSubmit" value="Print Envelope">
                            <input type="submit" class="btn btn-primary" name="submit" id="labelSubmit" value="Print Label">
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Plot prices modal-->
    <div class="modal fade" role="dialog" id="plotPrices">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Current Plotting Prices</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <iframe class="plotting-iframe" src="billplot/plottingPrices.php"></iframe>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/jquery-3.3.1.js"></script>
    <script src="assets/js/jquery.mask.js"></script>
    <script src="assets/js/bootstrap.bundle.js"></script>
    <script src="assets/js/bootstrap.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
    $("#jobNumber").change(function(e){         //fill address inputs when job number changes
        e.preventDefault();
        $("#clientCode").val("");
        $("#clientNames").empty();              //empty out the datalist of client names before inserting new names
        addrFill($(this).val(), "jobNumber", url="assets/php/fillAddress.php");
        skipAddr($("#company").val());
    });
    $("#clientCode").on("input", function(e){        //fill/change address inputs when client code changes
        e.preventDefault();
        $("#clientNames").empty();
        addrFill($(this).val(), "clientCode", url="assets/php/fillAddress.php");
        skipAddr($("#company").val());
    });



    function skipAddr(company){
        //if there's a company filled out after we call addrFill(), set those tab indices to -1 
        if(company){
            $("#company").attr("tabIndex", "-1");
            $("#addr1").attr("tabIndex", "-1");
            $("#addr2").attr("tabIndex", "-1");
            $("#city").attr("tabIndex", "-1");
            $("#state").attr("tabIndex", "-1");
            $("#zip").attr("tabIndex", "-1");
        }
    }

    // function toggleDropdown (e) {

    //     var toggle = $(this).find(".dropdown-toggle");
    //     var menu = $(this).find(".dropdown-menu");
    //     toggle.addClass("show");
    //     menu.addClass("show");
    //     setTimeout(function(){
    //         toggle[toggle.is(':hover') ? 'addClass' : 'removeClass']('show');
    //         menu[toggle.is(':hover') ? 'addClass' : 'removeClass']('show');
    //     }, 300)
    // }

    // $('body')
    // .on('mouseenter mouseleave','.btn-group',toggleDropdown)
    // .on('click', '.dropdown-menu a', toggleDropdown);

    $("#envelopeSubmit").click(function(e){
        e.preventDefault();
        var q = [];
        q.push($("#attention").val());
        q.push($("#company").val());
        q.push($("#addr1").val());
        if($("#addr2").val()) q.push($("#addr2").val());
        q.push($("#city").val());
        q.push($("#state").val());
        q.push($("#zip").val());

        qStr = JSON.stringify(q);
        console.log(qStr);

        $.ajax({
            method: "GET",
            url: "label-envelope/printEnvelope.php",
            data: {
                q: qStr
            }
        }).then(function(response){
            alert("Address for "+q[1]+" sent to Reception envelope printer");
        })
    });
    $("#labelSubmit").click(function(e){
        e.preventDefault();
        var q = [];
        q.push($("#jobNumber").val());
        q.push($("#attention").val());
        q.push($("#company").val());
        q.push($("#addr1").val());
        if($("#addr2").val()) q.push($("#addr2").val());
        q.push($("#city").val());
        q.push($("#state").val());
        q.push($("#zip").val());

        qStr = JSON.stringify(q);
        console.log(qStr);

        $.ajax({
            method: "GET",
            url: "label-envelope/printLabel.php",
            data: {
                q: qStr
            }
        }).then(function(response){
            alert("Address for "+q[2]+" sent to label printer");
        })
    });

    $("#attention").change(function(){
        if($(this).val().length < 5 && $("#clientCode").val()){
            signName($(this), $(this).val(), $("#clientCode").val(), "assets/php/signName.php");
        } 
    })

    
    </script>
</body>
</html>